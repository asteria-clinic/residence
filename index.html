<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>居住地アンケート</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
      background: #f5f5f5;
    }
    h2 {
      margin-bottom: 20px;
    }
    select, button {
      font-size: 1.1rem;
      padding: 12px;
      margin-top: 20px;
      width: 90%;
      max-width: 320px;
      box-sizing: border-box;
    }
    button {
      background-color: #06c755;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>現在住んでいる都道府県を選択してください</h2>
  <select id="prefecture">
    <option value="" disabled selected>都道府県を選択</option>
    <option>北海道</option>
    <option>青森県</option>
    <option>岩手県</option>
    <option>宮城県</option>
    <option>秋田県</option>
    <option>山形県</option>
    <option>福島県</option>
    <option>茨城県</option>
    <option>栃木県</option>
    <option>群馬県</option>
    <option>埼玉県</option>
    <option>千葉県</option>
    <option>東京都</option>
    <option>神奈川県</option>
    <option>新潟県</option>
    <option>富山県</option>
    <option>石川県</option>
    <option>福井県</option>
    <option>山梨県</option>
    <option>長野県</option>
    <option>岐阜県</option>
    <option>静岡県</option>
    <option>愛知県</option>
    <option>三重県</option>
    <option>滋賀県</option>
    <option>京都府</option>
    <option>大阪府</option>
    <option>兵庫県</option>
    <option>奈良県</option>
    <option>和歌山県</option>
    <option>鳥取県</option>
    <option>島根県</option>
    <option>岡山県</option>
    <option>広島県</option>
    <option>山口県</option>
    <option>徳島県</option>
    <option>香川県</option>
    <option>愛媛県</option>
    <option>高知県</option>
    <option>福岡県</option>
    <option>佐賀県</option>
    <option>長崎県</option>
    <option>熊本県</option>
    <option>大分県</option>
    <option>宮崎県</option>
    <option>鹿児島県</option>
    <option>沖縄県</option>
    <option>海外</option>
  </select>

  <button id="submit">送信する</button>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyeweFh97FpLvb7syO4TXRyD6f76lt2yGQva8X4R5ODLTni4qjxMEGHVf0MyRFjGMfw/exec"; // ← 必要に応じて変更

    document.addEventListener("DOMContentLoaded", async () => {
      try {
        // LIFF初期化はミニアプリでは不要なので省略
        const accessToken = liff.getAccessToken();
        const profile = await liff.getProfile();
        const userId = profile.userId;

        document.getElementById("submit").addEventListener("click", async () => {
          const pref = document.getElementById("prefecture").value;
          if (!pref) return alert("都道府県を選択してください");

          try {
            await fetch(GAS_URL, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                accessToken: accessToken,
                prefecture: pref,
              }),
            });

            alert("ご回答ありがとうございました！");
            liff.closeWindow();
          } catch (error) {
            alert("送信に失敗しました: " + error);
            console.error(error);
          }
        });

      } catch (error) {
        alert("LIFFエラーが発生しました（LINEアプリから開いていますか？）");
        console.error(error);
      }
    });
  </script>
</body>
</html>
